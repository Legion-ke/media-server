services:
  jellyfin:
    image: jellyfin/jellyfin:latest
    container_name: jellyfin
    network_mode: host # Critical for DLNA/Casting
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
    volumes:
      - ./jellyfin/config:/config
      # Single volume for atomic moves
      - /mnt/media/media:/data
    devices:
      # INTEL QUICK SYNC (For your UHD 620)
      - /dev/dri:/dev/dri

  # ==========================================
  # DOWNLOADER
  # ==========================================
  qbittorrent:
    image: lscr.io/linuxserver/qbittorrent:latest
    container_name: qbittorrent
    network_mode: host # Critical for DHT/Magnet links
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
      - WEBUI_PORT=8080
    volumes:
      - ./qbittorrent/config:/config
      # Maps to the same structure as Jellyfin/Sonarr
      - /mnt/media/media:/data

  # ==========================================
  # THE "ARR" STACK
  # ==========================================
  sonarr:
    image: lscr.io/linuxserver/sonarr:latest
    container_name: sonarr
    network_mode: host
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
    volumes:
      - ./sonarr/config:/config
      - /mnt/media/media:/data

  radarr:
    image: lscr.io/linuxserver/radarr:latest
    container_name: radarr
    network_mode: host
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
    volumes:
      - ./radarr/config:/config
      - /mnt/media/media:/data

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    network_mode: host
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
    volumes:
      - ./prowlarr/config:/config

  # (Optional: Prowlarr does everything Jackett does but better.
  # You can keep this if you have specific legacy needs.)
  jackett:
    image: lscr.io/linuxserver/jackett:latest
    container_name: jackett
    network_mode: host
    restart: unless-stopped
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Africa/Nairobi
    volumes:
      - ./jackett/config:/config
      - /mnt/media/media/Downloads:/downloads

  jellyseerr:
    image: ghcr.io/fallenbagel/jellyseerr:latest
    container_name: jellyseerr
    network_mode: host # Easier to connect to Sonarr/Radarr on localhost
    init: true
    restart: unless-stopped
    environment:
      - LOG_LEVEL=debug
      - TZ=Africa/Nairobi
    volumes:
      - ./jellyseerr/appdata/config:/app/config

  # ==========================================
  # UTILITIES
  # ==========================================
  uptime-kuma:
    image: louislam/uptime-kuma:1
    container_name: uptime-kuma
    network_mode: host
    volumes:
      - ./uptime-kuma-data:/app/data
    restart: always

  requestrr:
    image: darkalfx/requestrr
    container_name: requestrr
    network_mode: host
    volumes:
      - ./requestrr/config:/root/config
    restart: unless-stopped
